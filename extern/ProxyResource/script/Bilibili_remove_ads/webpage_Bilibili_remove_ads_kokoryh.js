// Built at: 2025/7/25 07:07:32
function y(n={}){let e=Object.create(null),t=r=>typeof r=="string"?r.toLowerCase():r;for(let[r,o]of Object.entries(n))e[t(r)]=o;let s={get(r,o){return Reflect.get(r,t(o))},set(r,o,i){return Reflect.set(r,t(o),i)},has(r,o){return Reflect.has(r,t(o))},deleteProperty(r,o){return Reflect.deleteProperty(r,t(o))},ownKeys(r){return Reflect.ownKeys(r)},getOwnPropertyDescriptor(r,o){return Reflect.getOwnPropertyDescriptor(r,t(o))},defineProperty(r,o,i){return Reflect.defineProperty(r,t(o),i)}};return new Proxy(e,s)}function b(n){return typeof n!="object"||n===null?String(n):typeof n.toString=="function"&&n.toString!==Object.prototype.toString?Array.isArray(n)?JSON.stringify(n):n.toString():n instanceof RegExp?n.toString():n instanceof Date?n.toISOString():JSON.stringify(n)}var f=class n{static getInstance(e){let t="Surge";if(typeof $loon<"u")t="Loon";else if(typeof $task<"u")throw new Error("QuantumultX is not supported");return n.instances[t]||(n.instances[t]=n.classNames[t](e,t)),n.instances[t]}static classNames={Surge:(e,t)=>new d(e,t),Loon:(e,t)=>new m(e,t)};static instances={};className;name;logLevels={debug:1,info:2,warn:3,error:4,off:5};logLevel=this.logLevels.error;request;response;argument;_url;get url(){return this._url||(this._url=new URL(this.request.url)),this._url}constructor(e,t){this.className=t??"",this.name=e??"",this.init()}createProxy(e){return new Proxy(e,{get:this.getFn,set:this.setFn})}getFn(e,t,s){return Reflect.get(e,t,s)}setFn(e,t,s,r){return Reflect.set(e,t,s,r),!0}getJSON(e){let t=this.getVal(e);return t?JSON.parse(t):null}setJSON(e,t){this.setVal(JSON.stringify(e),t)}logWithPrefix(e,t){console.log(`${e}${t.map(s=>b(s)).join(" | ")}`)}log(...e){this.logWithPrefix("",e)}debug(...e){this.logLevel>this.logLevels.debug||this.logWithPrefix("[DEBUG]",e)}info(...e){this.logLevel>this.logLevels.info||this.logWithPrefix("[INFO]",e)}warn(...e){this.logLevel>this.logLevels.warn||this.logWithPrefix("[WARN]",e)}error(...e){this.logLevel>this.logLevels.error||this.logWithPrefix("[ERROR]",e)}exit(){$done({})}abort(){$done()}},d=class n extends f{static propertyMap={bodyBytes:"body"};getFn(e,t,s){let r=n.propertyMap[t]||t;return super.getFn(e,r,s)}setFn(e,t,s,r){let o=n.propertyMap[t]||t;return super.setFn(e,o,s,r)}init(){typeof $request=="object"&&(this.request=this.createProxy($request)),typeof $response=="object"&&(this.response=this.createProxy($response)),typeof $argument=="string"&&(this.argument=JSON.parse($argument),"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}getVal(e){return $persistentStore.read(e)}setVal(e,t){return $persistentStore.write(e,t)}fetch(e){let{method:t,body:s,timeout:r=5,...o}=e;return new Promise((i,p)=>{$httpClient[t]({...o,body:s,"binary-mode":s instanceof Uint8Array,timeout:r},(c,a,u)=>{if(c)return p(c);let S=u instanceof Uint8Array?"bodyBytes":"body";i({status:a.status,headers:a.headers,[S]:u})})})}notify(e=this.name,t="",s="",r={}){let{openUrl:o,clipboard:i,mediaUrl:p,dismiss:c,sound:a=!0}=r,u={url:o,text:i,"media-url":p,"auto-dismiss":c,sound:a};o?u.action="open-url":i&&(u.action="clipboard"),$notification.post(e,t,s,u)}ungzip(e){return $utils.ungzip(e)}done(e){$done(e)}abort(){$done({abort:!0})}},m=class extends d{init(){super.init(),typeof $argument=="object"&&(this.argument=$argument,"logLevel"in this.argument&&(this.logLevel=this.logLevels[this.argument.logLevel]??this.logLevels.error))}fetch(e){return e.timeout=(e.timeout??5)*1e3,super.fetch(e)}notify(e=this.name,t="",s="",r={}){let{openUrl:o,mediaUrl:i,clipboard:p,delay:c}=r,a={openUrl:o,mediaUrl:i,clipboard:p};$notification.post(e,t,s,a,c)}abort(){$done()}};var l=class{$;message;domParser=new DOMParser;styleTemplate;scriptTemplate;scriptFilter;constructor(e){if(!y(e.response.headers)["content-type"]?.includes("text/html"))throw new Error("Invalid URL");this.$=e,this.message=this.fromString(e.response.body)}done(){this.process(),this.$.done({body:this.toString()})}process(){if(this.scriptFilter&&this.remove(this.query("script").filter(this.scriptFilter)),this.scriptTemplate){let e=this.message.createElement("script");e.textContent=this.scriptTemplate,this.append(this.message.head,e)}if(this.styleTemplate){let e=this.message.createElement("style");e.textContent=this.styleTemplate,this.append(this.message.head,e)}}fromString(e){return this.domParser.parseFromString(e,"text/html")}toString(){return`<!DOCTYPE HTML>${this.message.documentElement.outerHTML}`}query(e){return Array.from(this.message.querySelectorAll(e))}append(e,...t){return t.map(s=>e.appendChild(s))}remove(e){return e.map(t=>t.parentElement?.removeChild(t))}};var g=class extends l{styleTemplate="div[data-module*=eva-layout-container],div[data-module*=eva-image],div[data-module*=eva-link-button]{display:none!important}\n"};var h=f.getInstance("Bilibili HTML");try{new g(h).done()}catch(n){h.error(n,h.request.url)}finally{h.exit()}