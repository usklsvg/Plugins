name: |-
  汽水音乐去广告
desc: |-
  移除开屏广告、弹窗广告、播放器推广、歌曲详情界面视频推广、播放页面的歌曲视频，精简首页和我的页面。
author: |-
  可莉🅥[https://github.com/luestr/ProxyResource/blob/main/README.md]
icon: |-
  https://raw.githubusercontent.com/luestr/IconResource/main/App_icon/120px/SodaMusic.png
category: |-
  iKeLee
openUrl: |-
  https://apps.apple.com/app/id1605585211
tag: |-
  去广告
loon_version: |-
  3.2.4(787)
homepage: |-
  https://hub.kelee.one
date: |-
  2025-08-31 05:46:14

http:

  mitm:
    - "webcast-open.douyin.com"
    - "beta-luna.douyin.com"
    - "api.qishui.com"
    - "api5-lq.qishui.com"
    - "tnc*-*.zijieapi.com"

  url-rewrite:
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/commerce\/upsells_config\? - reject-dict
    - >-
      ^https:\/\/(api|api5-lq)\.qishui\.com\/luna\/ads\/ - reject-dict
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/ads\/ - reject-dict
    - >-
      ^https:\/\/webcast-open\.douyin\.com\/webcast\/openapi\/feed\/\? - reject-dict
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/treasure\/entrance\/config\? - reject-dict
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/activities\? - reject-dict
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/media_ads\? - reject-dict
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/commerce\/upsells\? - reject-dict
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/commerce\/v2\/commerce_info\? - reject-dict
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/listen-video\/reminder\? - reject-dict

  body-rewrite:
    - >-
      ^https:\/\/tnc\d-(bjlgy|ali[a-z]{2})\d?\.zijieapi\.com\/get_domains\/v\d\/\? response-jq if (getpath(["data"]) | has("opaque_data_enabled")) then (setpath(["data","opaque_data_enabled"]; 0)) else . end
    - >-
      ^https:\/\/tnc\d-(bjlgy|ali[a-z]{2})\d?\.zijieapi\.com\/get_domains\/v\d\/\? response-jq if (getpath(["data"]) | has("ttnet_http_dns_enabled")) then (setpath(["data","ttnet_http_dns_enabled"]; 0)) else . end
    - >-
      ^https:\/\/tnc\d-(bjlgy|ali[a-z]{2})\d?\.zijieapi\.com\/get_domains\/v\d\/\? response-jq if (getpath(["data"]) | has("ttnet_quic_enabled")) then (setpath(["data","ttnet_quic_enabled"]; 0)) else . end
    - >-
      ^https:\/\/tnc\d-(bjlgy|ali[a-z]{2})\d?\.zijieapi\.com\/get_domains\/v\d\/\? response-jq if (getpath(["data"]) | has("ttnet_tt_http_dns")) then (setpath(["data","ttnet_tt_http_dns"]; 0)) else . end
    - >-
      ^https:\/\/tnc\d-(bjlgy|ali[a-z]{2})\d?\.zijieapi\.com\/get_domains\/v\d\/\? response-jq .data.ttnet_dispatch_actions |= map(select(.action != "dispatch" and .action != "tc"))
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/me\? response-jq delpaths([["reward_ad_banner"]])
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/feed\/song-tab\? response-jq del(.items[] | select(.type == "video_track_mix"))
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/card\? response-jq delpaths([["preview_guide"]])
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/card\? response-jq del(.card_items[] | select(has("priority_display")))
    - >-
      ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/more-panel\? response-jq .blocks |= map(select(.type != "related_video"))

  script:
    - match: ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/me\/recently-played-media\?
      name: "移除播放页面视频流_30"
      type: response
      require-body: true

script-providers:
  "移除播放页面视频流_30":
    url: https://kelee.one/Resource/JavaScript/SodaMusic/SodaMusic_remove_ads.js
    interval: 86400

